<!DOCTYPE html>
<html xmlns:fb="https://www.facebook.com/2008/fbml">
<html>
<head>
    <script src="js/jquery-1.7.1.min.js"></script>
    <script src="js/transparency.js"></script>
    <title>Face Event</title>
    <script type="text/javascript">
        $(function() {

            $("#fb-auth").click(function() {
                FB.getLoginStatus(function(response){
                    if (response.status === 'connected') {
                        // Logged in, authorized
                        // response.authResponse supplies userID, accessToken, signedRequest, time, expiry
                        onLogin(response)

                    } else if (response.status === 'not_authorized') {
                        // Logged in, but not authorized
                        alert('Not Authorized');
                    } else if (response.status === 'unknown') {
                        // Not logged in
                        FB.login(function(response) {
                            if (response.authResponse) {
                                onLogin(response)

                            }
                            else {
                                // User not logged
                                console.log('User cancelled login');
                            }
                        }, {scope: 'user_events,friends_events,read_friendlists'});
                    }
                    showLoader(false);
                });
            })

            function onLogin(response) {
                // User now logged
                console.log('Welcome!  Fetching your information.... ');
                FB.api('/me', function(user) {
                    if (user) {
                        var image = document.getElementById('image');
                        image.src = 'https://graph.facebook.com/' + user.id + '/picture';
                        var name = document.getElementById('name');
                        name.innerHTML = user.name
                    }
                });
                //getList()
                friendsQuery()
                //$(this).hide();
            }
            <!--var eventId = new Array(100)-->
            <!--var eventName = new Array(100)-->
            <!--var eventStartTime = new Array(100)-->
            <!--var eventEndTime = new Array(100)-->
            <!--var eventLocation = new Array(100)-->

            function friendsQuery(){
                FB.api('/me/friends', function(response) {
                    <!--if(response.data.length)   $("#facevent").removeClass("empty")-->
                    <!--$("#friends ul").render(response.data)-->
                    var l1=response.data.length;
                    var i=0;
                    var j = 0;
                    var k = 0;
                    var l2;
                    var eventId = new Array()
                    var eventName = new Array()
                    var eventStartTime = new Array()
                    var eventEndTime = new Array()
                    var eventLocation = new Array()

                    for (i=0; i < l1;  i++) {
                        var idValue = response.data[i].id;
                        FB.api('/' + idValue + '/events', function(event) {

                            if (event.data.length) {
                                <!--alert('inside loop')-->
                                l2=event.data.length;
                                <!--alert(l2)-->
                                for(k=0; k < l2; k++) {
                                    <!--alert(event.data[k].id)-->
                                    var num = event.data[k].id;
                                    alert(num)
                                    eventId[j] = num;
                                    eventName[j] = event.data[k].name;
                                    eventStartTime[j] = event.data[k].start_time;
                                    eventEndTime[j] = event.data[k].end_time;
                                    eventLocation[j] = event.data[k].location;
                                    <!--alert(event.data[k])-->
                                    <!--alert(eventArray[j])-->
                                    j++;
                                    <!--alert(j)-->
                                }
                            }
                        });

                    }
                    if (i == l1) alert('hello')
                    <!--$("#friends ul").render(eventArray)-->
                        <!--FB.api('/' + id + '/events', function(event) {-->
                            <!--$("#friends ul").render(event.data)-->
                        <!--});-->

               });
            }
            <!--function getList() {-->
                <!--$.ajax({-->
                    <!--url: "PROFILE_ID/friendlists",-->
                    <!--success: showFriends(response)-->
                <!--});-->
            <!--}-->
            <!--function showFriends(response) {-->
                <!--alert(response[1].name)-->
            <!--}-->


        })
    </script>
</head>
<body>
        <iframe src="https://www.facebook.com/plugins/like.php?href=http://localhost:8080"
            scrolling="no" frameborder="0"
            style="border:none; width:450px; height:80px">
        </iframe>

        <div id="fb-root"></div>
        <script>
            window.fbAsyncInit = function() {
                FB.init({
                    appId      : '181429478637839',
                    status     : true,
                    cookie     : true,
                    xfbml      : true,
                    oauth      : true
                });

                showLoader(true);



            };


            // Load the SDK Asynchronously
            (function(d){
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
            }(document));


            function showLoader(status) {
                if (status)
                    document.getElementById('loader').style.display = 'block';
                else
                    document.getElementById('loader').style.display = 'none';
            }

        </script>

    <h1>FaceEvent</h1>
    <div id="faceevent" class="empty">
        <div id="loader" style="display:none">
            <img src="Images/loader.gif" alt="Loading"/>
        </div>
        <button id="fb-auth">Login with facebook</button>
        <!--
        <div class="fb-login-button" data-show-faces="true" data-width="200" data-max-rows="2" data-scope="user_events,friends_events">
            Login with Facebook
        </div>
        -->
        <div align="center">
            <img id="image"/>
            <div id="name"></div>
        </div>
        <div id="friends">
            <h2>Events your friends are going to</h2>
            <table border="0">
                <tr>
                    <th>Event Name</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Location</th>
                    <th>Description</th>
                </tr>

                    <tr>

                        <td><ul style="list-style: none;"><li class="name"></li></ul></td>
                        <td><ul style="list-style: none;"><li class="start_time"></li></ul></td>
                        <td><ul style="list-style: none;"><li class="end_time"></li></ul></td>
                        <td><ul style="list-style: none;"><li class="location"></li></ul></td>
                        <td><ul style="list-style: none;"><li class="description"></li></ul></td>

                    </tr>

            </table>
        </div>

    </div>
</body>
</html>
</html>